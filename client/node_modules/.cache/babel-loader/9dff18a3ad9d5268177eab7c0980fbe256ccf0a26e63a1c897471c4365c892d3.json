{"ast":null,"code":"var _jsxFileName = \"D:\\\\mid-project-582786\\\\source\\\\fe\\\\src\\\\context\\\\SocketContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport { createContext, useContext, useState, useEffect } from \"react\";\n//import SockJS from \"sockjs-client\";\nimport { over } from \"stompjs\";\nimport { useAuth } from \"./AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SocketContext = /*#__PURE__*/createContext();\nexport const SocketProvider = ({\n  children\n}) => {\n  _s();\n  const {\n    username\n  } = useAuth();\n  const [stompClient, setStompClient] = useState(null);\n  useEffect(() => {\n    if (!username) return;\n    const connectWebSocket = () => {\n      const socket = new SockJS(\"http://localhost:8080/ws\");\n      const client = over(socket);\n      client.connect({}, () => {\n        console.log(\"✅ Connected WebSocket\");\n        client.send(\"/app/chat.addUser\", {}, JSON.stringify({\n          sender: username\n        }));\n      });\n      setStompClient(client);\n    };\n    connectWebSocket();\n  }, [username]);\n  return /*#__PURE__*/_jsxDEV(SocketContext.Provider, {\n    value: {\n      stompClient\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 5\n  }, this);\n};\n_s(SocketProvider, \"L1FaZeOGIsz/BmllUtWY5gZFRxA=\", false, function () {\n  return [useAuth];\n});\n_c = SocketProvider;\nexport const useMessageListener = callback => {\n  _s2();\n  useEffect(() => {\n    socketService.onMessage(callback);\n  }, [callback]);\n};\n_s2(useMessageListener, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\nexport const useTypingListener = callback => {\n  _s3();\n  // Nếu FE đang gọi useTypingListener, ta chỉ mock tạm\n  useEffect(() => {\n    const interval = setInterval(() => {\n      callback && callback(\"Mock user đang nhập...\");\n    }, 7000);\n    return () => clearInterval(interval);\n  }, [callback]);\n};\n_s3(useTypingListener, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\nexport const useSocket = () => {\n  _s4();\n  return useContext(SocketContext);\n};\n_s4(useSocket, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"SocketProvider\");","map":{"version":3,"names":["createContext","useContext","useState","useEffect","over","useAuth","jsxDEV","_jsxDEV","SocketContext","SocketProvider","children","_s","username","stompClient","setStompClient","connectWebSocket","socket","SockJS","client","connect","console","log","send","JSON","stringify","sender","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useMessageListener","callback","_s2","socketService","onMessage","useTypingListener","_s3","interval","setInterval","clearInterval","useSocket","_s4","$RefreshReg$"],"sources":["D:/mid-project-582786/source/fe/src/context/SocketContext.js"],"sourcesContent":["import { createContext, useContext, useState, useEffect } from \"react\";\r\n//import SockJS from \"sockjs-client\";\r\nimport { over } from \"stompjs\";\r\nimport { useAuth } from \"./AuthContext\";\r\n\r\nconst SocketContext = createContext();\r\n\r\nexport const SocketProvider = ({ children }) => {\r\n  const { username } = useAuth();\r\n  const [stompClient, setStompClient] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (!username) return;\r\n\r\n    const connectWebSocket = () => {\r\n      const socket = new SockJS(\"http://localhost:8080/ws\");\r\n      const client = over(socket);\r\n      client.connect({}, () => {\r\n        console.log(\"✅ Connected WebSocket\");\r\n        client.send(\"/app/chat.addUser\", {}, JSON.stringify({ sender: username }));\r\n      });\r\n      setStompClient(client);\r\n    };\r\n\r\n    connectWebSocket();\r\n  }, [username]);\r\n\r\n  return (\r\n    <SocketContext.Provider value={{ stompClient }}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  );\r\n};\r\nexport const useMessageListener = (callback) => {\r\n  useEffect(() => {\r\n    socketService.onMessage(callback);\r\n  }, [callback]);\r\n};\r\n\r\nexport const useTypingListener = (callback) => {\r\n  // Nếu FE đang gọi useTypingListener, ta chỉ mock tạm\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      callback && callback(\"Mock user đang nhập...\");\r\n    }, 7000);\r\n    return () => clearInterval(interval);\r\n  }, [callback]);\r\n};\r\n\r\n\r\nexport const useSocket = () => useContext(SocketContext);\r\n\r\n"],"mappings":";;;;;AAAA,SAASA,aAAa,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AACtE;AACA,SAASC,IAAI,QAAQ,SAAS;AAC9B,SAASC,OAAO,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,aAAa,gBAAGR,aAAa,CAAC,CAAC;AAErC,OAAO,MAAMS,cAAc,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EAC9C,MAAM;IAAEC;EAAS,CAAC,GAAGP,OAAO,CAAC,CAAC;EAC9B,MAAM,CAACQ,WAAW,EAAEC,cAAc,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EAEpDC,SAAS,CAAC,MAAM;IACd,IAAI,CAACS,QAAQ,EAAE;IAEf,MAAMG,gBAAgB,GAAGA,CAAA,KAAM;MAC7B,MAAMC,MAAM,GAAG,IAAIC,MAAM,CAAC,0BAA0B,CAAC;MACrD,MAAMC,MAAM,GAAGd,IAAI,CAACY,MAAM,CAAC;MAC3BE,MAAM,CAACC,OAAO,CAAC,CAAC,CAAC,EAAE,MAAM;QACvBC,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;QACpCH,MAAM,CAACI,IAAI,CAAC,mBAAmB,EAAE,CAAC,CAAC,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEC,MAAM,EAAEb;QAAS,CAAC,CAAC,CAAC;MAC5E,CAAC,CAAC;MACFE,cAAc,CAACI,MAAM,CAAC;IACxB,CAAC;IAEDH,gBAAgB,CAAC,CAAC;EACpB,CAAC,EAAE,CAACH,QAAQ,CAAC,CAAC;EAEd,oBACEL,OAAA,CAACC,aAAa,CAACkB,QAAQ;IAACC,KAAK,EAAE;MAAEd;IAAY,CAAE;IAAAH,QAAA,EAC5CA;EAAQ;IAAAkB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACa,CAAC;AAE7B,CAAC;AAACpB,EAAA,CAzBWF,cAAc;EAAA,QACJJ,OAAO;AAAA;AAAA2B,EAAA,GADjBvB,cAAc;AA0B3B,OAAO,MAAMwB,kBAAkB,GAAIC,QAAQ,IAAK;EAAAC,GAAA;EAC9ChC,SAAS,CAAC,MAAM;IACdiC,aAAa,CAACC,SAAS,CAACH,QAAQ,CAAC;EACnC,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;AAChB,CAAC;AAACC,GAAA,CAJWF,kBAAkB;AAM/B,OAAO,MAAMK,iBAAiB,GAAIJ,QAAQ,IAAK;EAAAK,GAAA;EAC7C;EACApC,SAAS,CAAC,MAAM;IACd,MAAMqC,QAAQ,GAAGC,WAAW,CAAC,MAAM;MACjCP,QAAQ,IAAIA,QAAQ,CAAC,wBAAwB,CAAC;IAChD,CAAC,EAAE,IAAI,CAAC;IACR,OAAO,MAAMQ,aAAa,CAACF,QAAQ,CAAC;EACtC,CAAC,EAAE,CAACN,QAAQ,CAAC,CAAC;AAChB,CAAC;AAACK,GAAA,CARWD,iBAAiB;AAW9B,OAAO,MAAMK,SAAS,GAAGA,CAAA;EAAAC,GAAA;EAAA,OAAM3C,UAAU,CAACO,aAAa,CAAC;AAAA;AAACoC,GAAA,CAA5CD,SAAS;AAAA,IAAAX,EAAA;AAAAa,YAAA,CAAAb,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}